<form name="createSurgicalBlockForm">
<div class="patient-info-fixed-postion-container ot-secondary-header">
    <p class="navigation-links-buttons">
        <span class="add-new-appointment">{{'ADD_NEW_SURGICAL_BLOCK' | translate}}</span>
        <input type="button" value="{{'DISCARD' | translate}}" class="ot-nav-back" ng-confirm-click="goToHome()"/>
        <input type="submit" value="{{'SAVE' | translate}}" ng-click="save(surgicalForm)" class="ot-nav-save"/>
    </p>
</div>
<div class="new-surgical-appointment" >
    <p class="new-surgical-appointment-note">You can block operation theatre time for a Surgeon and can arrange multiple surgical appointments into this block.</p>
    <section class="new-surgical-appointment-step1">
        <div class="create-surgical-form">
            <h4 class="create-surgical-title">{{'CREATE_SURGICAL_BLOCK' | translate}}</h4>
            <div class="appointment-block">
                <p class="surgeon-block">
                    <label class="surgeon-block surgeon-text">{{'SURGEON' | translate}}<sup>*</sup></label>
                    <select ng-options="surgeon as surgeon.person.display for surgeon in ::surgeons track by surgeon.uuid"
                            ng-model="surgicalForm.provider"
                            required>
                        <option value=""> Select Surgeon </option>
                    </select>
                </p>
                <p class="location-block">
                    <label>Location<sup>*</sup></label>
                    <span ng-repeat="location in locations track by location.uuid">
                        <label class="location-buttons" for="{{location.display}}">
                            <i ng-if="location.name == surgicalForm.location.name" class="fa fa-check" aria-hidden="true"></i>
                            {{ location.display }}
                            <input type="radio" id="{{location.display}}" name="location" ng-value="location"
                                   ng-model="surgicalForm.location" required/>
                        </label>
                    </span>
                </p>
                <p>
                    <span class="start-time">
                        <label>Start Date-time<sup>*</sup></label>
                        <input type="datetime-local" ng-model="surgicalForm.startDatetime" required
                               ng-class="{'illegalValue' : !isStartDatetimeBeforeEndDatetime(surgicalForm.startDatetime, surgicalForm.endDatetime)}">
                    </span>
                    <span class="start-time">
                        <label>End Date-time<sup>*</sup></label>
                        <input type="datetime-local" ng-model="surgicalForm.endDatetime" ng-class="{'illegalValue' : !isStartDatetimeBeforeEndDatetime(surgicalForm.startDatetime,
                         surgicalForm.endDatetime)}" required>
                    </span>
                </p>
            </div>
        </div>
    </section>

    <section class="new-surgical-appointment-step2">
                <h4 class="create-surgical-title">{{'ADD_SURGERY_STEP' | translate}}
                    <button ng-disabled="!isFormValid()" ng-click="addNewSurgicalAppointment()">
                        {{'OT_ADD_SURGERY_KEY' | translate}}
                    </button>
                </h4>
                <table class="table">
                    <thead>
                    <tr>
                        <th>{{'SURGERY_DETAILS' | translate}}</th>
                        <th>{{'ACTION' | translate}}</th>
                    </tr>
                    </thead>
                    <tbody dnd-list="surgicalForm.surgicalAppointments">
                    <tr ng-repeat="surgicalAppointment in surgicalForm.surgicalAppointments"
                        dnd-draggable="surgicalAppointment"
                        dnd-moved="surgicalForm.surgicalAppointments.splice($index, 1)"
                        dnd-effect-allowed="move"
                        dnd-dragend="updateSortWeight()"
                    >
                        <td>
                            <h4>{{getPatientName(surgicalAppointment)}}</h4>
                            <p>
                                <span ng-if="surgicalAppointment.surgicalAppointmentAttributes.procedure.value" ><b>{{'OT_SURGICAL_APPOINTMENT_PROCEDURE' | translate}}</b> - {{surgicalAppointment.surgicalAppointmentAttributes.procedure.value}}, </span>
                                <span ng-if="surgicalAppointment.surgicalAppointmentAttributes.estTimeHours.value || surgicalAppointment.surgicalAppointmentAttributes.estTimeMinutes.value"><b> {{'OT_SURGICAL_APPOINTMENT_ESTIMATED_TIME' | translate}}</b> - {{surgicalAppointment.surgicalAppointmentAttributes.estTimeHours.value}} {{'OT_SURGICAL_APPOINTMENT_HOURS' | translate}} : {{surgicalAppointment.surgicalAppointmentAttributes.estTimeMinutes.value}} {{'OT_SURGICAL_APPOINTMENT_MINUTES' | translate}}, </span>
                                <span ng-if="surgicalAppointment.surgicalAppointmentAttributes.cleaningTime.value"><b> {{'OT_SURGICAL_APPOINTMENT_CLEANING_TIME' | translate}}</b> - {{surgicalAppointment.surgicalAppointmentAttributes.cleaningTime.value}} {{'OT_SURGICAL_APPOINTMENT_MINUTES' | translate}}, </span>
                                <span ng-if="surgicalAppointment.surgicalAppointmentAttributes.otherSurgeon.value.person.display"><b> {{'OT_SURGICAL_APPOINTMENT_OTHER_SURGEON' | translate}}</b> {{surgicalAppointment.surgicalAppointmentAttributes.otherSurgeon.value.person.display}}, </span>
                                <span ng-if="surgicalAppointment.surgicalAppointmentAttributes.surgicalAssistant.value"><b> {{'OT_SURGICAL_APPOINTMENT_SURGICAL_ASSISTANT' | translate}}</b> - {{surgicalAppointment.surgicalAppointmentAttributes.surgicalAssistant.value}}, </span>
                                <span ng-if="surgicalAppointment.surgicalAppointmentAttributes.anaesthetist.value"><b> {{'OT_SURGICAL_APPOINTMENT_ANAESTHETIST' | translate}}</b> - {{surgicalAppointment.surgicalAppointmentAttributes.anaesthetist.value}}, </span>
                                <span ng-if="surgicalAppointment.surgicalAppointmentAttributes.scrubNurse.value"><b> {{'OT_SURGICAL_APPOINTMENT_SCRUB_NURSE' | translate}}</b> - {{surgicalAppointment.surgicalAppointmentAttributes.scrubNurse.value}}, </span>
                                <span ng-if="surgicalAppointment.surgicalAppointmentAttributes.circulatingNurse.value"><b> {{'OT_SURGICAL_APPOINTMENT_CIRCULATING_NURSE' | translate}}</b> - {{surgicalAppointment.surgicalAppointmentAttributes.circulatingNurse.value}}, </span>
                                <span ng-if="surgicalAppointment.notes"><b> {{'OT_SURGICAL_APPOINTMENT_NOTES' | translate}}</b> - {{surgicalAppointment.notes}}</span>
                            </p>
                        </td>
                        <td class="appointment-edit">
                            <a id="edit-appointment" href ng-click="editAppointment(surgicalAppointment)">Edit</a>
                            <a id="cancel-appointment" href ng-click="">Cancel</a>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </section>
        </div>
        </form>
