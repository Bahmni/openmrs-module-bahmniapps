<div class="vitals form-horizontal">
    <fieldset ng-if="observation.isObservationNode">
        <div class="form-group">
            <label class="control-label">
                <span>{{observation.primaryObs.label}}&nbsp;</span>
                <span ng-show="observation.units">({{observation.primaryObs.units}})</span>
                <span ng-if="observation.isRequired()" class="asterick">*</span>
            </label>
            <div class="field-value" ng-switch on="observation.getControlType()">

                <div ng-switch-when="html5InputDataType">
                    <input obs-constraints obs="observation.primaryObs"
                           ng-model="observation.value" ng-class="{'illegalValue': !observation.isValid(atLeastOneValueIsSet)}"/>
                </div>

                <textarea ng-switch-when="text" ng-model="observation.value"
                          ng-class="{'illegalValue': !observation.isValid(atLeastOneValueIsSet)}"></textarea>

                <select ng-switch-when="dropdown" foo-bar ng-model="observation.value"
                        ng-class="{'illegalValue': !observation.isValid(atLeastOneValueIsSet)}"
                        ng-options="answer as answer.name for answer in getPossibleAnswers() track by answer.uuid"> <option value=""></option>
                </select>

                <input ng-switch-when="freeTextAutocomplete" class="concept-name" ng-model="observation.value" concept-autocomplete
                       ng-class="{'illegalValue': !observation.isValid(atLeastOneValueIsSet)}"
                       coded-concept-uuid="observation.getConceptUIConfig().freeTextAutocomplete.codedConceptUuid"
                       concept-set-uuid="observation.getConceptUIConfig().freeTextAutocomplete.conceptSetUuid"
                       blur-on-select="false"/>

                <div ng-switch-when="autocomplete"  ng-class="{'illegalValue': !observation.isValid(atLeastOneValueIsSet)}" class="autocomplete">
                    <input type="hidden" ui-select2="selectOptions" ng-model="observation.value"/>
                </div>

                <!--div ng-switch-when="multiselect"  ng-class="{'illegalValue': !observation.isValid(atLeastOneValueIsSet)}" class="autocomplete">
                    <div ui-select2="multiSelectOptions" ng-model="observation.value"></div>
                </div-->

                <p ng-switch-default class="field-value info icon-info-sign"> The concept data type '{{observation.dataTypeName}}' is not supported yet.</p>
            </div>
            <small class="hint" ng-show="observation.primaryObs.concept.lowNormal || observation.primaryObs.concept.hiNormal">(Valid Range from {{observation.primaryObs.concept.lowNormal}} to {{observation.primaryObs.concept.hiNormal}})</small>
            <div class="checkbox-inline" ng-if="observation.abnormal">
                <input id="isAbnormal-{{$index}}" type="checkbox" ng-model="observation.abnormal.value" ng-disabled="!observation.primaryObs.hasValue()"/>
                <span for="isAbnormal-{{$index}}">Abnormal</span>
            </div>
            <div class="checkbox-inline" ng-if="observation.duration" ng-class="{'duration': observation.duration}">
                <span>for</span><duration ng-model="observation.duration.value" disabled="!observation.primaryObs.hasValue()" illegal-value="!observation.isValid(atLeastOneValueIsSet)"></duration>
            </div>
        </div>
    </fieldset>

    <fieldset ng-if="!observation.isObservationNode" class="hasLegend">
        <legend class="mylegend"><strong>{{observation.label}}</strong></legend>
        <div class="form-group">
            <div class="form-field form-field-group" ng-repeat="member in observation.groupMembers">
                <concept observation="member" at-least-one-value-is-set="atLeastOneValueIsSet"></concept>
            </div>
        </div>
    </fieldset>
</div>